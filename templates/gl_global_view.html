{% extends 'gl_base.html' %}

{% block content %}

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- script src=" https://cdn.jsdelivr.net/npm/chart.js@~4.1.1"></script>
  <script src="../build/index.umd.js"></script>
  <script src=" https://cdn.jsdelivr.net/npm/d3-random@latest/dist/d3-random.min.js"></script>
  <script src="./utils.js"></script-->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="container rounded-2" style="background-color:  #d5dbdb  !important; color: black">
    <div class="row">
      </div>
      <div class="col">
        <h2 align="center">Données globales</h2>
      </div>
    </div>
  </div>
  <br/>
  <div class="container">
    <div class="container">
    <div class="row">
      <div class="col-4">
        <div class="container">
          <div class="row">
            <div class="col">
              <div class="card h-100 text-white mb-3" style="background-color: #EDAE49 !important;">
                <div class="card-header border-0 fs-6" align="center" style="background-color: #EDAE49 !important;">
                  <strong>Jeux possédés</strong>
                </div>
                <div class="card-body">
                  <p class="card-text fs-2" align="center"><strong>{{total}}</strong></p>
                </div>
              </div>
            </div>
          </div>
          <br/>
          <div class="row">
            <div class="col">
              <div class="card h-100 text-white mb-3" style="background-color:  #D1495B  !important;">
                <div class="card-header border-0 fs-6" align="center" style="background-color:  #D1495B  !important;">
                  <strong>Jeux terminés</strong>
                </div>
                <div class="card-body">
                  <p class="card-text fs-3" align="center"><strong>{{finished}}</strong></p>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="card h-100 text-white mb-3" style="background-color:  #00798C  !important;">
                <div class="card-header border-0 fs-6" align="center" style="background-color:  #00798C  !important;">
                  <strong>Jeux lancé (non finis)</strong>
                </div>
                <div class="card-body">
                  <p class="card-text fs-3" align="center"><strong>{{played}}</strong></p>
                </div>
              </div>
            </div>
          </div>
          <br/>
          <div class="row">
            <div class="col">
              <div class="card h-100 text-white mb-3" style="background-color:  #30638E  !important;">
                <div class="card-header border-0 fs-6" align="center" style="background-color:  #30638E  !important;">
                  <strong>MMO/Multi/GaaS</strong>
                </div>
                <div class="card-body">
                  <p class="card-text fs-3" align="center"><strong>{{unfinishable}}</strong></p>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="card h-100 text-white mb-3" style="background-color:   #003D5B   !important;">
                <div class="card-header border-0 fs-6" align="center" style="background-color:  #003D5B  !important;">
                  <strong>Jamais lancés</strong>
                </div>
                <div class="card-body">
                  <p class="card-text fs-3" align="center"><strong>{{untouched}}</strong></p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col">
          <div class="card h-100">
            <div class="card-body">
              <div id="container2">
                <canvas id="global-owned-pie" data-url="{% url 'GamesLibrary:global-owned-pie' %}" width="400" height="250"></canvas>
              </div>
          </div>
      </div>
    </div>
    </div>
  </div>
  <br/>
  <div class="container">
    <div class="row">
      <div class="col">
        <div class="container">
          <div class="card h-100 text-white mb-3" style="background-color: #EDAE49 !important;">
            <div class="card-body">
              <p class="card-text fs-4" align="center">Temps passé dans des jeux vidéo: <strong>
                {% if total_time_cal.years > 1 %}
                {{total_time_cal.years}} ans,
                {% else %}
                {{total_time_cal.years}} an,
                {% endif %} 
                {% if total_time_cal.days > 1 %}
                {{total_time_cal.days}} jours,
                {% else %}
                {{total_time_cal.days}} jour,
                {% endif %}
                {% if total_time_cal.hours > 1 %}
                {{total_time_cal.hours}} heures
                {% else %}
                {{total_time_cal.hours}} heure
                {% endif %}
                et
                {% if total_time_cal.minutes > 1 %}
                {{total_time_cal.minutes}} minutes
                {% else %}
                {{total_time_cal.minutes}} minute
                {% endif %}
                </strong></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <br/>
  <div class="container">
    <div class="row">
      <div class="col">
        <div class="container">
          <div class="row">
            <div class="col">
              <div class="card h-100 text-white mb-3" style="background-color: #EDAE49 !important;">
                <div class="card-header border-0 fs-6" align="center" style="background-color: #EDAE49 !important;">
                  <strong>Genres différents</strong>
                </div>
                <div class="card-body">
                  <p class="card-text fs-2" align="center"><strong>{{number_genre}}</strong></p>
                </div>
              </div>
            </div>
          </div>
          <br/>
          <div class="row">
            <div class="col">
              <div class="card h-100 text-white mb-3" style="background-color:  #D1495B  !important;">
                <div class="card-header border-0 fs-6" align="center" style="background-color:  #D1495B  !important;">
                  <strong>Genre le plus représenté</strong>
                </div>
                <div class="card-body">
                  <p class="card-text fs-3" align="center"><strong>{{best_genre.genre}}</strong></p>
                </div>
              </div>
            </div>
          </div>
          <br/>
          <div class="row">
            <div class="col">
              <div class="card h-100 text-white mb-3" style="background-color:  #00798C  !important;">
                <div class="card-header border-0 fs-6" align="center" style="background-color:  #00798C  !important;">
                  <strong>Nombre de jeux "{{best_genre.genre}}"</strong>
                </div>
                <div class="card-body">
                  <p class="card-text fs-3" align="center"><strong>{{best_genre.total}}</strong></p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-6">
        <div class="card h-100">
          <div class="card-body">
            <div id="container2">
              <canvas id="global-genre-pie" data-url="{% url 'GamesLibrary:global-genre-pie' %}" width="400" height="300"></canvas>
            </div>
          </div>
        </div>
      </div>
      <div class="col">
        <div class="container">
          <div class="row">
            <div class="col">
              <div class="card h-100 text-white mb-3" style="background-color:  #30638E  !important;">
                <div class="card-header border-0 fs-6" align="center" style="background-color:  #30638E  !important;">
                  <strong>Genre chronophage</strong>
                </div>
                <div class="card-body">
                <p class="card-text fs-3" align="center"><strong>{{long_genre.genre}}</strong></p>
                </div>
              </div>
            </div>
          </div>
          <br/>
          <div class="row">
            <div class="col">
              <div class="card h-100 text-white mb-3" style="background-color:  #003D5B  !important;">
                <div class="card-header border-0 fs-6" align="center" style="background-color:  #003D5B  !important;">
                  <strong>Temps dans "{{long_genre.genre}}"</strong>
                </div>
                <div class="card-body">
                  <p class="card-text fs-3" align="center"><strong>{{long_genre_hours}} H {{long_genre_minutes}}</strong></p>
                </div>
              </div>
            </div>
          </div>
          <br/>
          <div class="row">
            <div class="col">
              <div class="card h-100 text-white mb-3" style="background-color: #EDAE49 !important;">
                <div class="card-header border-0 fs-6" align="center" style="background-color: #EDAE49 !important;">
                  <strong>Genre sous-représenté</strong>
                </div>
                <div class="card-body">
                  <p class="card-text fs-2" align="center"><strong>{{low_genre.genre}}</strong></p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<br/>
</body>
<!-- best_genre, best_genre_hours, best_genre_minutes,
                   'low_genre':low_genre, 'low_genre_hours':low_genre_hours, 'low_genre_minutes':low_genre_minutes,
                   'long_genre':long_genre, 'long_genre_hours':long_genre_hours, 'long_genre_minutes':long_genre_minutes,
                   'short_genre':short_genre, 'short_genre_hours':short_genre_hours, 'short_genre_minutes':short_genre_minutes,
                   'lpg_genre':lpg_genre, 'lpg_genre_hours':lpg_genre_hours, 'lpg_genre_minutes':lpg_genre_minutes,
                   'spg_genre':spg_genre, 'spg_genre_hours':spg_genre_hours, 'spg_genre_minutes':spg_genre_minutes -->

<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
<script>

    $(function () {

      var $globalPlateformPie = $("#global-platform-pie");
      $.ajax({
        url: $globalPlateformPie.data("url"),
        success: function (data) {

          var ctx = $globalPlateformPie[0].getContext("2d");

          new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: data.labels,
                datasets: [{
                    label: 'Games by platform',
                    data: data.data,
                    hoverOffset: 4,
                    backgroundColor: data.bkgrnd
                }],
            },
            options: {
              responsive: false,
              title: {
                display: true,
                text: 'Games by platform'
              }
            }
          });

        }
      });

    });

  </script>
  <script>

    $(function () {

      var $timeGenreChart = $("#time-genre-chart");
      $.ajax({
        url: $timeGenreChart.data("url"),
        success: function (data) {

          var ctx = $timeGenreChart[0].getContext("2d");

          new Chart(ctx, {
            type: 'bar',
            data: {
                datasets: [{
                label: 'Time spent per genre (hours)',
                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                borderColor: 'rgb(255, 99, 132)',
                borderWidth: 1,
                data: data.data2,
                order: 2
                }, {
                label: 'Time spent per game (hours)',
                data: data.data,
                type: 'line',
                fill: false,
                borderColor: 'rgb(54, 162, 235)',
                order: 1
                 }],
       labels: data.labels,
   },
            options: {
                legend: {
                display: true
                },
                scales: {
                    yAxes: [{
                        ticks: {
                        beginAtZero: true
                        },
                        gridLines: {
                        display:true
                        }
                        }],
                    xAxes: [{
                        gridLines: {
                        display:true
                        }
                        }]
                        },
              responsive: false,
              title: {
                display: true,
                text: 'Time spent'
              }
            }
          });

        }
      });

    });

  </script>
  <script>

    $(function () {

      var $globalGenrePie = $("#global-genre-pie");
      $.ajax({
        url: $globalGenrePie.data("url"),
        success: function (data) {

          var ctx = $globalGenrePie[0].getContext("2d");

          new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: data.labels,
                datasets: [{
                    label: 'Games by genre',
                    data: data.data,
                    hoverOffset: 4,
                    backgroundColor: data.bkgrnd
                }],
            },
            options: {
              legend: {
                display: true,
                position: 'right'
                },
              responsive: true,
              title: {
                display: false,
                text: 'Games by genre'
              }
            }
          });

        }
      });

    });

  </script>

<script>

  $(function () {

    var $globalOwnedPie = $("#global-owned-pie");
    $.ajax({
      url: $globalOwnedPie.data("url"),
      success: function (data) {

        var ctx = $globalOwnedPie[0].getContext("2d");

        new Chart(ctx, {
          type: 'pie',
          data: {
            labels: data.labels,
              datasets: [{
                  label: 'Jeux possédés',
                  data: data.data,
                  hoverOffset: 4,
                  backgroundColor: data.bkgrnd
              }],
          },
          options: {
              responsive: true,
              title: {
                display: false,
                text: 'Jeux possédés'
              },
              legend: {
                display: true,
                position: 'right'
                },
          }
        });

      }
    });

  });

</script>

{% endblock %}